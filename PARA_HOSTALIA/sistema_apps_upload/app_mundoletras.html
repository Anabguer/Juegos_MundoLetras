<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="theme-color" content="#1e3a8a">
    <meta name="description" content="Mundo Letras - Juego de sopa de letras con más de 1000 niveles">
    
    <!-- PWA Meta Tags -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Mundo Letras">
    
    <title>Mundo Letras - Sopa de Letras</title>
    
    <!-- Google Fonts - Poppins -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="sistema_apps_api/mundoletras/styles.css">
    
    <style>
        /* Efecto de letras cayendo */
        .falling-letters {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            pointer-events: none;
            z-index: 1;
            overflow: hidden;
        }
        
        .falling-letter {
            position: absolute;
            color: rgba(255, 255, 255, 0.3);
            font-size: 1.6rem;
            font-weight: bold;
            font-family: 'Poppins', sans-serif;
            animation: fall linear infinite;
            user-select: none;
        }
        
        @keyframes fall {
            0% {
                transform: translateY(-50px) rotate(0deg);
                opacity: 0;
            }
            5% {
                opacity: 0.3;
            }
            95% {
                opacity: 0.3;
            }
            100% {
                transform: translateY(calc(100vh + 50px)) rotate(360deg);
                opacity: 0;
            }
        }
        
        /* Asegurar que la tarjeta esté por encima */
        .login-screen {
            position: relative;
            z-index: 2;
        }
    </style>
    
</head>
<body>
    <!-- Efecto de letras cayendo -->
    <div class="falling-letters" id="falling-letters"></div>
    
    <!-- Login Screen -->
    <div id="login-screen" class="screen login-screen active">
        <div class="login-card">
            <img src="sistema_apps_api/mundoletras/img/Logo.png" alt="Mundo Letras" class="title-logo">
            <p class="subtitle">Rompe rutinas: + de mil sopas de letras con sorpresas en cada nivel</p>
            
            <div id="login-content">
                <button class="btn btn-primary" onclick="smartPlay()">
                    ¡JUGAR!
                </button>
                
                <button class="btn btn-secondary" onclick="showLogin()">
                    Identificarse
                </button>
                
                <button class="btn btn-secondary" onclick="showScreen('test-screen'); testLevel();" style="background: #fbbf24; color: #000; font-weight: bold; display: none;">
                    PANTALLA DE TEST
                </button>
                
                <button class="btn btn-secondary" onclick="window.open('font_test.html', '_blank');" style="background: #8b5cf6; color: #fff; font-weight: bold; display: none;">
                    PRUEBA DE FUENTES
                </button>
                
            </div>
            
            <div id="message-container"></div>
        </div>
    </div>
    
    <!-- Test Screen -->
    <div id="test-screen" class="screen test-screen">
        <div class="test-container">
            <h2>🧪 Pantalla de Test</h2>
            <p>Verifica niveles, palabras y colores</p>
            
            <div class="test-controls">
                <div class="input-group">
                    <label for="test-level-input">Nivel a probar:</label>
                    <div class="level-controls">
                        <button onclick="testPreviousLevel()" class="btn btn-secondary btn-sm">← Anterior</button>
                        <input type="number" id="test-level-input" min="1" max="1000" value="1" class="test-input">
                        <button onclick="testNextLevel()" class="btn btn-secondary btn-sm">Siguiente →</button>
                    </div>
                    <button onclick="testLevel()" class="btn btn-primary">Probar Nivel</button>
                </div>
            </div>
            
            <div id="test-results" class="test-results">
                <div class="test-info">
                    <h3>Información del Nivel</h3>
                    <div class="info-grid">
                        <div class="info-item">
                            <span class="info-label">Nivel:</span>
                            <span id="test-level-display">-</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Tema:</span>
                            <span id="test-theme-display">-</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Ciclo:</span>
                            <span id="test-cycle-display">-</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Posición:</span>
                            <span id="test-position-display">-</span>
                        </div>
                    </div>
                </div>
                
                <div class="test-words">
                    <h3>Palabras del Nivel</h3>
                    <div id="test-words-display" class="words-list">
                        <p>Selecciona un nivel para ver las palabras</p>
                    </div>
                </div>
                
                <div class="test-config">
                    <h3>Configuración del Nivel</h3>
                    <div id="test-config-display" class="config-list">
                        <p>Selecciona un nivel para ver la configuración</p>
                    </div>
                </div>
            </div>
            
            <div class="test-actions">
                <button onclick="showScreen('login-screen')" class="btn btn-secondary">Volver al Login</button>
                <button onclick="testRandomLevel()" class="btn btn-primary">Nivel Aleatorio</button>
            </div>
        </div>
    </div>
    
    <!-- Game Screen -->
    <div id="game-screen" class="screen game-screen">
        <!-- Header horizontal: Logo izquierda, Nivel centro, Botones derecha -->
        <div class="game-header">
            <div class="header-logo">
                <img src="sistema_apps_api/mundoletras/img/Logo.png" alt="Mundo Letras" class="game-logo">
            </div>
            <div class="header-level">
                <h2>Nivel <span id="level-display">1</span></h2>
            </div>
            <div class="header-buttons">
                <button class="header-btn" onclick="backToMenu()" title="Menú" aria-label="Menú">
                    <svg class="hud-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
                        <polyline points="9,22 9,12 15,12 15,22"></polyline>
                    </svg>
                </button>
                <button class="header-btn" id="sound-control" onclick="toggleSound()" title="Altavoz" aria-label="Altavoz">
                    <svg class="hud-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon>
                        <path d="M19.07 4.93a10 10 0 0 1 0 14.14M15.54 8.46a5 5 0 0 1 0 7.07"></path>
                    </svg>
                </button>
                <button class="header-btn" onclick="showRanking()" title="Ranking" aria-label="Ranking">
                    <svg class="hud-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M6 9H4.5a2.5 2.5 0 0 1 0-5H6"></path>
                        <path d="M18 9h1.5a2.5 2.5 0 0 0 0-5H18"></path>
                        <path d="M4 22h16"></path>
                        <path d="M10 14.66V17c0 .55-.47.98-.97 1.21l-1.25.5c-.5.2-1.28.2-1.78 0l-1.25-.5A1.25 1.25 0 0 1 4 17v-2.34"></path>
                        <path d="M14 14.66V17c0 .55.47.98.97 1.21l1.25.5c.5.2 1.28.2 1.78 0l1.25-.5c.5-.23.97-.66.97-1.21v-2.34"></path>
                        <path d="M18 2H6v7a6 6 0 0 0 12 0V2Z"></path>
                    </svg>
                </button>
            </div>
        </div>
        
        <!-- HUD -->
        <div class="game-hud">
            <!-- Primera lí­nea: Información del usuario -->
            
            <!-- Segunda línea: Estadí­sticas del juego -->
            <div class="hud-stats-line">
                <div class="hud-item" title="Monedas">
                    <svg class="hud-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <circle cx="9" cy="9" r="6"></circle>
                        <circle cx="15" cy="15" r="6"></circle>
                        <path d="M9 9h6v6"></path>
                    </svg>
                    <span id="coins" class="hud-value">50</span>
                </div>
                <div class="hud-item" title="Tiempo">
                    <svg class="hud-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <circle cx="12" cy="12" r="10"></circle>
                        <polyline points="12,6 12,12 16,14"></polyline>
                    </svg>
                    <span id="level-timer" class="hud-value">0:00</span>
                </div>
                <button class="hud-item" onclick="useHint()" title="Pista" aria-label="Pista">
                    <svg class="hud-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M9 21c0 .55.45 1 1 1h4c.55 0 1-.45 1-1v-1H9v1z"></path>
                        <path d="M12 2C8.14 2 5 5.14 5 9c0 2.38 1.19 4.47 3 5.74V17c0 .55.45 1 1 1h6c.55 0 1-.45 1-1v-2.26c1.81-1.27 3-3.36 3-5.74 0-3.86-3.14-7-7-7z"></path>
                    </svg>
                </button>
            </div>
        </div>
        
        <!-- Display de Mecánicas Activas -->
        <div id="mechanics-display" class="mechanics-display" style="display: none;">
            <!-- Las mecánicas se mostrarán aquí­ dinámicamente -->
        </div>
        
        <!-- Game Grid -->
        <div id="game-grid" class="game-grid">
            <!-- Cells will be generated by JavaScript -->
        </div>
        
        <!-- Current Word Display (palabra en progreso) -->
        <div id="current-word-display" class="current-word-display" style="display: none;">
            <span id="current-word-text"></span>
        </div>
        
        <!-- Words List -->
        <div id="words-list" class="words-list">
            <!-- Words will be generated by JavaScript -->
        </div>
        
                <!-- Game Controls -->
        <div class="game-controls">
            <button class="btn btn-primary btn-sm" onclick="useHint()" id="hint-button" data-icon="💡" title="Usar Pista">
                💡 Pista
            </button>
            <button class="btn btn-secondary btn-sm" onclick="showRanking()" data-icon="🏆" title="VerRanking">
                🏆 Ranking
            </button>
            <button class="btn btn-secondary btn-sm" onclick="backToMenu()" id="back-menu-btn" data-icon="��" title="Volver al Menú">
                🏠 Volver al Menú
            </button>
            <button class="btn btn-secondary btn-sm" onclick="clearGuestProgress()" id="clear-progress-btn" style="display: none;" data-icon="—‘🔄" title="Reiniciar Progreso">
                🔄Reiniciar Progreso
            </button>
            <button class="btn btn-secondary btn-sm" onclick="logout()" id="logout-btn" style="display: none;" data-icon="🚪" title="Cerrar Sesión">
                🚪 Cerrar Sesión
            </button>
        </div>


    <!-- JavaScript externo -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bodymovin/5.12.2/lottie.min.js"></script>
    <script src="sistema_apps_api/mundoletras/js/game.js"></script>
    <script src="sistema_apps_api/mundoletras/js/api.js"></script>
    <script src="sistema_apps_api/mundoletras/js/mechanics.js"></script>
    <script src="sistema_apps_api/mundoletras/js/grid.js"></script>
    <script src="sistema_apps_api/mundoletras/js/remaining.js"></script>
    <script>
        // Código de inicializacin y funciones no duplicadas
        
        // Efecto de letras cayendo
        function createFallingLetter() {
            const letters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
            const letter = letters[Math.floor(Math.random() * letters.length)];
            
            const fallingLetter = document.createElement('div');
            fallingLetter.className = 'falling-letter';
            fallingLetter.textContent = letter;
            
            // Posición aleatoria horizontal
            fallingLetter.style.left = Math.random() * 100 + '%';
            
            // Duración más rápida para evitar atascos (6-10 segundos)
            const duration = 6 + Math.random() * 4;
            fallingLetter.style.animationDuration = duration + 's';
            
            // Sin delay para que caigan inmediatamente
            fallingLetter.style.animationDelay = '0s';
            
            document.getElementById('falling-letters').appendChild(fallingLetter);
            
            // Remover la letra después de que termine la animación
            setTimeout(() => {
                if (fallingLetter.parentNode) {
                    fallingLetter.parentNode.removeChild(fallingLetter);
                }
            }, (duration + 3) * 1000);
        }
        
        // Variable para controlar el intervalo de letras cayendo
        let fallingLettersInterval = null;
        
        // Crear letras cayendo
        function startFallingLetters() {
            // Limpiar cualquier intervalo existente
            if (fallingLettersInterval) {
                clearInterval(fallingLettersInterval);
            }
            
            // Crear letras cada 800ms para más densidad
            fallingLettersInterval = setInterval(createFallingLetter, 800);
            
            // Crear algunas letras iniciales con buena separación
            for (let i = 0; i < 5; i++) {
                setTimeout(createFallingLetter, i * 300);
            }
        }
        
        // Detener letras cayendo
        function stopFallingLetters() {
            if (fallingLettersInterval) {
                clearInterval(fallingLettersInterval);
                fallingLettersInterval = null;
            }
            
            // Limpiar todas las letras existentes
            const fallingLettersContainer = document.getElementById('falling-letters');
            if (fallingLettersContainer) {
                fallingLettersContainer.innerHTML = '';
            }
        }
        
        // Inicialización cuando se carga la página
        document.addEventListener('DOMContentLoaded', function() {
            // Solo iniciar efecto de letras cayendo en la pantalla de login
            if (document.getElementById('login-screen').classList.contains('active')) {
                startFallingLetters();
            }
            
            // Manejar orientación
            window.addEventListener('orientationchange', function() {
                setTimeout(() => {
                    window.scrollTo(0, 0);
                }, 100);
            });
        });
    </script>
</body>
</html>









